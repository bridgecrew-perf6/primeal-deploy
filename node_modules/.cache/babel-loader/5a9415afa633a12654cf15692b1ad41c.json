{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nexports.__esModule = true;\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\n\nvar _inheritsLoose2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inheritsLoose\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _Initialize = _interopRequireDefault(require(\"./Initialize\"));\n\nvar _Subscribe = _interopRequireDefault(require(\"./Subscribe\"));\n\nvar _Fields = _interopRequireDefault(require(\"./constants/Fields\"));\n\nvar _LoginStatus = _interopRequireDefault(require(\"./constants/LoginStatus\"));\n\nvar Profile = /*#__PURE__*/function (_Component) {\n  (0, _inheritsLoose2.default)(Profile, _Component);\n\n  function Profile() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _Component.call.apply(_Component, [this].concat(args)) || this;\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"state\", {\n      loading: true\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"handleReady\", function _callee(api) {\n      return _regenerator.default.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _this.api = api;\n\n              _this.updateProfile();\n\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      });\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"handleStatusChange\", function () {\n      _this.updateProfile();\n    });\n    return _this;\n  }\n\n  var _proto = Profile.prototype;\n\n  _proto.updateProfile = function updateProfile() {\n    var api, fields, response, profile;\n    return _regenerator.default.async(function updateProfile$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            api = this.api, fields = this.props.fields;\n\n            if (api) {\n              _context2.next = 3;\n              break;\n            }\n\n            return _context2.abrupt(\"return\");\n\n          case 3:\n            _context2.prev = 3;\n            _context2.next = 6;\n            return _regenerator.default.awrap(api.getLoginStatus());\n\n          case 6:\n            response = _context2.sent;\n\n            if (!(response.status !== _LoginStatus.default.CONNECTED)) {\n              _context2.next = 10;\n              break;\n            }\n\n            this.setState({\n              profile: undefined,\n              loading: false,\n              error: undefined\n            });\n            return _context2.abrupt(\"return\");\n\n          case 10:\n            _context2.next = 12;\n            return _regenerator.default.awrap(api.getProfile({\n              fields: fields\n            }));\n\n          case 12:\n            profile = _context2.sent;\n            this.setState({\n              profile: profile,\n              loading: false,\n              error: undefined\n            });\n            _context2.next = 19;\n            break;\n\n          case 16:\n            _context2.prev = 16;\n            _context2.t0 = _context2[\"catch\"](3);\n            this.setState({\n              profile: undefined,\n              loading: false,\n              error: _context2.t0\n            });\n\n          case 19:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, this, [[3, 16]]);\n  };\n\n  _proto.render = function render() {\n    var children = this.props.children;\n    var _this$state = this.state,\n        profile = _this$state.profile,\n        loading = _this$state.loading,\n        error = _this$state.error;\n    return _react.default.createElement(_Initialize.default, {\n      onReady: this.handleReady\n    }, _react.default.createElement(_Subscribe.default, {\n      event: \"auth.statusChange\",\n      onChange: this.handleStatusChange\n    }, children({\n      profile: profile,\n      loading: loading,\n      error: error\n    })));\n  };\n\n  return Profile;\n}(_react.Component);\n\nexports.default = Profile;\n(0, _defineProperty2.default)(Profile, \"defaultProps\", {\n  fields: _Fields.default\n});","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;AACA;;AACA;;AACA;;AACA;;AACA;;IAaqBA,O;;;;;;;;;;;wFAKJ;AACbC,aAAO,EAAE;AADI;8FAID,iBAAOC,GAAP;AAAA;AAAA;AAAA;AAAA;AACZC,oBAAKD,GAAL,GAAWA,GAAX;;AAEAC,oBAAKC,aAAL;;AAHY;AAAA;AAAA;AAAA;AAAA;AAAA;;qGAMO,YAAY;AAC/BD,YAAKC,aAAL;;;;;;;SAGIA,gBAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AACUF,eADV,GACqC,KAA3BA,KAAcG,MADxB,GACqC,KAAtBC,KAAsB,CAAbD,MAAdH;;AADV,gBAEOA,GAFP;AAAAK;AAAA;AAAA;;AAAA;;AAAA;AAAAA;AAAAA;AAAA,8CAO2BL,GAAG,CAACM,cAAJN,EAP3B;;AAAA;AAOUO,oBAPV,iBAOUA;;AAPV,kBAQQA,QAAQ,CAACC,MAATD,KAAoBE,qBAAYC,SARxC;AAAAL;AAAA;AAAA;;AASM,iBAAKM,QAAL,CAAc;AACZC,qBAAO,EAAEC,SADG;AAEZd,qBAAO,EAAE,KAFG;AAGZe,mBAAK,EAAED;AAHK,aAAd;AATN;;AAAA;AAAAR;AAAA,8CAkB0BL,GAAG,CAACe,UAAJf,CAAe;AACnCG,oBAAM,EAANA;AADmC,aAAfH,CAlB1B;;AAAA;AAkBUY,mBAlBV,iBAkBUA;AAIN,iBAAKD,QAAL,CAAc;AACZC,qBAAO,EAAPA,OADY;AAEZb,qBAAO,EAAE,KAFG;AAGZe,mBAAK,EAAED;AAHK,aAAd;AAtBJR;AAAA;;AAAA;AAAAA;AAAAA;AA4BI,iBAAKM,QAAL,CAAc;AACZC,qBAAO,EAAEC,SADG;AAEZd,qBAAO,EAAE,KAFG;AAGZe,mBAAK;AAHO,aAAd;;AA5BJ;AAAA;AAAA;AAAA;AAAA;AAAA;;;SAoCAE,2BAAS;AAAA,QACCC,QADD,GACc,KAAKb,KAAL,CAAba,QADD;AAAA,sBAE6B,KAAKC,KAFlC;AAAA,QAECN,OAFD,eAECA,OAFD;AAAA,QAEUb,OAFV,eAEUA,OAFV;AAAA,QAEmBe,KAFnB,eAEmBA,KAFnB;AAIP,WACEK,6BAACC,mBAAD;AAAYC,aAAO,EAAE,KAAKC;AAA1B,OACEH,6BAACI,kBAAD;AAAWC,WAAK,EAAC,mBAAjB;AAAqCC,cAAQ,EAAE,KAAKC;AAApD,OACGT,QAAQ,CAAC;AACRL,aAAO,EAAPA,OADQ;AAERb,aAAO,EAAPA,OAFQ;AAGRe,WAAK,EAALA;AAHQ,KAAD,CADX,CADF,CADF;;;;EA3DiCa;;;8BAAhB7B,S,gBACG;AACpBK,QAAM,EAAEyB;AADY","names":["Profile","loading","api","_this","updateProfile","fields","props","_context2","getLoginStatus","response","status","LoginStatus","CONNECTED","setState","profile","undefined","error","getProfile","render","children","state","_react","_Initialize","onReady","handleReady","_Subscribe","event","onChange","handleStatusChange","Component","Fields"],"sources":["C:\\Users\\ryany\\OneDrive\\桌面\\primeal\\node_modules\\react-facebook\\src\\Profile.jsx"],"sourcesContent":["// @flow\nimport React, { Component } from 'react';\nimport Initialize from './Initialize';\nimport Subscribe from './Subscribe';\nimport Fields from './constants/Fields';\nimport LoginStatus from './constants/LoginStatus';\n\ntype Props = {\n  children: Function,\n  fields?: string[],\n};\n\ntype State = {\n  loading: Boolean,\n  profile?: Object,\n  error?: Error,\n};\n\nexport default class Profile extends Component<Props, State> {\n  static defaultProps = {\n    fields: Fields,\n  };\n\n  state: State = {\n    loading: true,\n  };\n\n  handleReady = async (api: Object): Promise<void> => {\n    this.api = api;\n\n    this.updateProfile();\n  }\n\n  handleStatusChange = (): void => {\n    this.updateProfile();\n  }\n\n  async updateProfile() {\n    const { api, props: { fields } } = this;\n    if (!api) {\n      return;\n    }\n\n    try {\n      const response = await api.getLoginStatus();\n      if (response.status !== LoginStatus.CONNECTED) {\n        this.setState({\n          profile: undefined,\n          loading: false,\n          error: undefined,\n        });\n\n        return;\n      }\n\n      const profile = await api.getProfile({\n        fields,\n      });\n\n      this.setState({\n        profile,\n        loading: false,\n        error: undefined,\n      });\n    } catch (error) {\n      this.setState({\n        profile: undefined,\n        loading: false,\n        error,\n      });\n    }\n  }\n\n  render() {\n    const { children } = this.props;\n    const { profile, loading, error } = this.state;\n\n    return (\n      <Initialize onReady={this.handleReady}>\n        <Subscribe event=\"auth.statusChange\" onChange={this.handleStatusChange}>\n          {children({\n            profile,\n            loading,\n            error,\n          })}\n        </Subscribe>\n      </Initialize>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"script"}