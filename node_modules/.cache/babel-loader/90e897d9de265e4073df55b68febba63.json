{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ryany\\\\OneDrive\\\\\\u684C\\u9762\\\\primeal\\\\src\\\\pages\\\\share\\\\components\\\\EditImgPreview.js\",\n    _s = $RefreshSig$();\n\nimport { useRef, useState } from 'react';\nimport styles from '../Share.module.scss';\nimport config from '../../../Config';\nimport { ReactComponent as Plus } from '../../../imgs/plus.svg';\nimport { ReactComponent as DeleteSm } from '../../../imgs/del.svg';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst EditImgPreview = props => {\n  _s();\n\n  const {\n    files,\n    setFiles,\n    errorState,\n    action\n  } = props;\n  const [dragId, setDragId] = useState('');\n  const fileInputRef = useRef(null);\n\n  const fileDeleteHandler = delFile => {\n    const fileArr = files.filter(file => file.name !== delFile.name);\n    setFiles(fileArr);\n  };\n\n  const dragHandler = currentFile => {\n    action === 'UPDATE' ? setDragId(currentFile.sid) : setDragId(currentFile.size);\n  };\n\n  const dropHandler = currentFile => {\n    console.log(currentFile);\n    const dragFile = action === 'UPDATE' ? files.find(file => file.sid === dragId) : files.find(file => file.size === dragId);\n    const dropFile = action === 'UPDATE' ? files.find(file => file.sid === currentFile.sid) : files.find(file => file.size === currentFile.size);\n    const dragFileIndex = files.indexOf(dragFile);\n    const dropFileIndex = files.indexOf(dropFile);\n    const reorderFiles = [...files];\n    reorderFiles.splice(dragFileIndex, 1, dropFile);\n    reorderFiles.splice(dropFileIndex, 1, dragFile);\n    setFiles(reorderFiles);\n  };\n\n  const createPreviewTemplate = files => {\n    return files.map((file, i) => {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-12\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `${styles['edit-preview-box']} d-flex flex-column `,\n          draggable: true,\n          onDragOver: e => e.preventDefault(),\n          onDragStart: () => dragHandler(file),\n          onDrop: () => dropHandler(file),\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: `${styles['edit-preview-title']} d-flex justify-content-between mb-3`,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"ch-cont-14 font-weight-bold pt-2\",\n              children: i + 1\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 59,\n              columnNumber: 15\n            }, this), action === 'UPDATE' ? '' : /*#__PURE__*/_jsxDEV(DeleteSm, {\n              className: `${styles['edit-del-button']}`,\n              onClick: () => fileDeleteHandler(file)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 63,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 56,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"d-flex justify-content-center\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `${styles['share-edit-preview']}`,\n              children: action === 'UPDATE' ? /*#__PURE__*/_jsxDEV(\"img\", {\n                src: config.HOST + '/' + file.share_imgPath,\n                alt: \"\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 72,\n                columnNumber: 19\n              }, this) : /*#__PURE__*/_jsxDEV(\"img\", {\n                src: URL.createObjectURL(file),\n                alt: \"\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 74,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 70,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 69,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 49,\n          columnNumber: 11\n        }, this)\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 9\n      }, this);\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"col-12 d-none d-md-block\",\n    children: [/*#__PURE__*/_jsxDEV(\"form\", {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-group\",\n        children: /*#__PURE__*/_jsxDEV(\"input\", {\n          ref: fileInputRef,\n          type: \"file\",\n          className: \"form-control-file\",\n          id: \"images\",\n          multiple: true,\n          style: {\n            display: 'none'\n          },\n          onChange: e => {\n            setFiles([...files, ...e.target.files]);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \" d-flex flex-wrap\",\n      children: [createPreviewTemplate(files), action === 'UPDATE' ? '' : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-12\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `${styles['share-edit-attach']} d-flex flex-column align-items-center justify-content-center`,\n          onClick: () => {\n            fileInputRef.current.click();\n          },\n          children: [/*#__PURE__*/_jsxDEV(Plus, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-primary\",\n            children: errorState.files\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 5\n  }, this);\n};\n\n_s(EditImgPreview, \"5YC4D1MoGvaS6XaD8X5RMK6YfhY=\");\n\n_c = EditImgPreview;\nexport default EditImgPreview;\n\nvar _c;\n\n$RefreshReg$(_c, \"EditImgPreview\");","map":{"version":3,"sources":["C:/Users/ryany/OneDrive/桌面/primeal/src/pages/share/components/EditImgPreview.js"],"names":["useRef","useState","styles","config","ReactComponent","Plus","DeleteSm","EditImgPreview","props","files","setFiles","errorState","action","dragId","setDragId","fileInputRef","fileDeleteHandler","delFile","fileArr","filter","file","name","dragHandler","currentFile","sid","size","dropHandler","console","log","dragFile","find","dropFile","dragFileIndex","indexOf","dropFileIndex","reorderFiles","splice","createPreviewTemplate","map","i","e","preventDefault","HOST","share_imgPath","URL","createObjectURL","display","target","current","click"],"mappings":"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","sourcesContent":["import { useRef, useState } from 'react';\r\nimport styles from '../Share.module.scss';\r\nimport config from '../../../Config';\r\n\r\nimport { ReactComponent as Plus } from '../../../imgs/plus.svg';\r\nimport { ReactComponent as DeleteSm } from '../../../imgs/del.svg';\r\n\r\nconst EditImgPreview = props => {\r\n  const { files, setFiles, errorState, action } = props;\r\n  const [dragId, setDragId] = useState('');\r\n  const fileInputRef = useRef(null);\r\n\r\n  const fileDeleteHandler = delFile => {\r\n    const fileArr = files.filter(file => file.name !== delFile.name);\r\n    setFiles(fileArr);\r\n  };\r\n\r\n  const dragHandler = currentFile => {\r\n    action === 'UPDATE'\r\n      ? setDragId(currentFile.sid)\r\n      : setDragId(currentFile.size);\r\n  };\r\n\r\n  const dropHandler = currentFile => {\r\n    console.log(currentFile);\r\n\r\n    const dragFile =\r\n      action === 'UPDATE'\r\n        ? files.find(file => file.sid === dragId)\r\n        : files.find(file => file.size === dragId);\r\n\r\n    const dropFile =\r\n      action === 'UPDATE'\r\n        ? files.find(file => file.sid === currentFile.sid)\r\n        : files.find(file => file.size === currentFile.size);\r\n\r\n    const dragFileIndex = files.indexOf(dragFile);\r\n    const dropFileIndex = files.indexOf(dropFile);\r\n    const reorderFiles = [...files];\r\n    reorderFiles.splice(dragFileIndex, 1, dropFile);\r\n    reorderFiles.splice(dropFileIndex, 1, dragFile);\r\n    setFiles(reorderFiles);\r\n  };\r\n\r\n  const createPreviewTemplate = files => {\r\n    return files.map((file, i) => {\r\n      return (\r\n        <div className=\"col-12\" key={i}>\r\n          <div\r\n            className={`${styles['edit-preview-box']} d-flex flex-column `}\r\n            draggable={true}\r\n            onDragOver={e => e.preventDefault()}\r\n            onDragStart={() => dragHandler(file)}\r\n            onDrop={() => dropHandler(file)}\r\n          >\r\n            <div\r\n              className={`${styles['edit-preview-title']} d-flex justify-content-between mb-3`}\r\n            >\r\n              <div className=\"ch-cont-14 font-weight-bold pt-2\">{i + 1}</div>\r\n              {action === 'UPDATE' ? (\r\n                ''\r\n              ) : (\r\n                <DeleteSm\r\n                  className={`${styles['edit-del-button']}`}\r\n                  onClick={() => fileDeleteHandler(file)}\r\n                />\r\n              )}\r\n            </div>\r\n            <div className=\"d-flex justify-content-center\">\r\n              <div className={`${styles['share-edit-preview']}`}>\r\n                {action === 'UPDATE' ? (\r\n                  <img src={config.HOST + '/' + file.share_imgPath} alt=\"\" />\r\n                ) : (\r\n                  <img src={URL.createObjectURL(file)} alt=\"\" />\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      );\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"col-12 d-none d-md-block\">\r\n      <form>\r\n        <div className=\"form-group\">\r\n          <input\r\n            ref={fileInputRef}\r\n            type=\"file\"\r\n            className=\"form-control-file\"\r\n            id=\"images\"\r\n            multiple\r\n            style={{ display: 'none' }}\r\n            onChange={e => {\r\n              setFiles([...files, ...e.target.files]);\r\n            }}\r\n          />\r\n        </div>\r\n      </form>\r\n      <div className=\" d-flex flex-wrap\">\r\n        {/* preview box */}\r\n        {createPreviewTemplate(files)}\r\n        {/* upload plus box */}\r\n        {action === 'UPDATE' ? (\r\n          ''\r\n        ) : (\r\n          <div className=\"col-12\">\r\n            <div\r\n              className={`${styles['share-edit-attach']} d-flex flex-column align-items-center justify-content-center`}\r\n              onClick={() => {\r\n                fileInputRef.current.click();\r\n              }}\r\n            >\r\n              <Plus />\r\n              <div className=\"text-primary\">{errorState.files}</div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EditImgPreview;\r\n"]},"metadata":{},"sourceType":"module"}